---
layout: post
title: "服务器磁盘爆掉2"
categories:
- js
tags:
- ubuntu


---

一早登录访问页面，又出现js加载不完全的现象！咦，似曾相识！

哈哈，这次可难道不倒我！

于是很熟练的跑道录音程序下的缓存目录，

    rm -rf *

万事大吉！！额，还是再确认下，磁盘还有多少。

    df -h
    
发现音频的缓存文件干掉后，只释放了2G的空间。明明应该有至少10G空间的，那消失的8G在哪呢。

后来，多方查证后，找到这么一句话：

> inux里的文件被删除后，空间没有被释放是因为在Linux系统中，通过rm或者文件管理器删除文件将会从文件系统的目录结构上解除链接(unlink).然而如果文件是被打开的(有一个进程正在使用)，那么进程将仍然可以读取该文件，磁盘空间也一直被占用。

其实就是，文件虽然被删，但是进程仍然存在，就会占用硬盘空间。 以下是解决办法：

* `lsof -n |grep deleted` 找到删除后仍然在进程中的文件。
* 删除对应的进程 `kill 8195`


又解决一坑。



参考：
[df查看空间已经占用%100，但是找不到大文件][1]
[ linux删除文件未释放空间问题处理][2]


  [1]: http://bbs.chinaunix.net/thread-4146272-1-1.html
  [2]: http://blog.csdn.net/donghustone/article/details/7085240